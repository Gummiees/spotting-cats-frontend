<div class="relative">
  <!-- Dropdown Button -->
  <button 
    type="button" 
    (click)="onToggleDropdown()"
    class="border border-gray-300 rounded-sm p-2 text-left inline-flex items-center w-full justify-between bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-300">
    <span [class]="displayTextClass()">{{ displayText() }}</span>
    <svg class="w-2.5 h-2.5 ms-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4"/>
    </svg>
  </button>

  <!-- Dropdown Menu -->
  <div 
    *ngIf="isOpen()"
    class="z-10 absolute top-full left-0 right-0 mt-1 bg-white rounded-sm shadow-sm border border-gray-200">
    
    <!-- Search Input -->
    <div class="p-3 border-b border-gray-200">
      <label for="search-input" class="sr-only">Search</label>
      <div class="relative">
        <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
          <svg class="w-4 h-4 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"/>
          </svg>
        </div>
        <input 
          type="text" 
          id="search-input"
          [placeholder]="placeholder()"
          [value]="searchQuery()"
          (input)="onSearchInput($event)"
          class="block w-full p-2 ps-10 text-sm text-gray-900 border border-gray-300 rounded-sm bg-white focus:outline-none focus:ring-2 focus:ring-gray-300 focus:border-gray-300 placeholder-gray-500"
          autocomplete="off">
      </div>
    </div>

    <!-- Options List -->
    <ul class="max-h-48 overflow-y-auto text-sm text-gray-700" aria-labelledby="dropdown-button">
      <li *ngFor="let option of filteredOptions(); trackBy: trackByOption">
        <div 
          (click)="onOptionSelect(option)"
          class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer">
          <span class="w-full text-sm font-medium text-gray-900">{{ option.label }}</span>
        </div>
      </li>
      
      <!-- No results message -->
      <li *ngIf="filteredOptions().length === 0" class="px-3 py-2 text-sm text-gray-500">
        No options found
      </li>
    </ul>

    <!-- Clear Selection Option -->
    <div *ngIf="selectedValue()" class="border-t border-gray-200">
      <button 
        type="button"
        (click)="onClearSelection()"
        class="flex items-center w-full p-3 text-sm font-medium text-red-600 hover:bg-gray-100 rounded-b-sm">
        <span class="material-symbols-outlined text-base me-2">delete_sweep</span>
        Clear selection
      </button>
    </div>
  </div>
</div> 